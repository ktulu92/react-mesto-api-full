(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{142:function(e,t,n){},448:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),o=n(23),s=n.n(o),i=n(22),r=(n(142),n(136)),l=n(4),u=n(5),p=n(137),d=n(138),j=n(1),_=function(e){var t=e.component,n=Object(d.a)(e,["component"]);return Object(j.jsx)(u.b,{children:function(){return n.loggedIn?Object(j.jsx)(t,Object(p.a)({},n)):Object(j.jsx)(u.a,{to:"./signup"})}})};var m=function(e){var t=e.isLoggedIn,n=e.email,c=e.onOut;return Object(j.jsxs)("header",{className:"header",children:[Object(j.jsx)("div",{className:"header__logo"}),Object(j.jsx)(u.b,{className:"header__enter",path:"/signup",children:Object(j.jsx)(i.b,{to:"/signup",className:"header__out",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})}),Object(j.jsx)(u.b,{className:"header__reg",path:"/signin",children:Object(j.jsx)(i.b,{to:"/signin",className:"header__out",children:"\u0412\u043e\u0439\u0442\u0438"})}),Object(j.jsx)(u.b,{path:"/",children:t&&Object(j.jsxs)("div",{className:"header__user-info",children:[Object(j.jsx)("p",{className:"header__email",children:n}),Object(j.jsx)("button",{className:"header__out",onClick:c,children:"\u0412\u044b\u0439\u0442\u0438"})]})})]})};var h=function(){return Object(j.jsx)("footer",{className:"footer",children:Object(j.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})},b=(n(151),n(134)),f=n(135),O=new(function(){function e(t,n){Object(b.a)(this,e),this.url=t,this.headers=n}return Object(f.a)(e,[{key:"getInitialCards",value:function(){return fetch("".concat(this.url)+"cards",{headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){console.log("\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d",e)}))}},{key:"addNewCard",value:function(e){var t=e.name,n=e.link;return fetch("".concat(this.url)+"cards",{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:n})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){console.log("\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d",e)}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this.url)+"cards/"+"".concat(e),{method:"DELETE",headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){console.log("\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d",e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?fetch("".concat(this.url)+"cards/likes/"+"".concat(e),{method:"PUT",headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){console.log("\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d",e)})):fetch("".concat(this.url)+"cards/likes/"+"".concat(e),{method:"DELETE",headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){console.log("\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d",e)}))}},{key:"updateUserAvatar",value:function(e){return fetch("".concat(this.url)+"users/me/avatar",{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e.avatar})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){console.log("\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d",e)}))}},{key:"getProfileInfo",value:function(){return fetch("".concat(this.url)+"users/me",{method:"GET",headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){console.log("\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d",e)}))}},{key:"editProfile",value:function(e){return fetch("".concat(this.url)+"users/me",{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).catch((function(e){console.log("\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d",e)}))}}]),e}())("https://mesto.nomoreparties.co/v1/cohort-17/",{authorization:"c9722db9-3ef8-471a-a8fd-61097de987b4","Content-Type":"application/json"}),g=a.a.createContext();var x=function(e){var t=a.a.useContext(g),n=e.card.owner._id===t._id,c=e.card.likes.some((function(e){return e._id===t._id})),o="element__like-button  ".concat(c&&"element__like-button_clicked"),s="element__delete-button ".concat(n?"element__delete-button_type_visible":"element__delete-button_type_hidden");return Object(j.jsx)("div",{className:"template-element",children:Object(j.jsxs)("li",{className:"element",children:[Object(j.jsx)("button",{className:s,onClick:function(){e.onCardDelete(e.card)}}),Object(j.jsx)("img",{className:"element__image",src:e.card.link,alt:e.card.name,onClick:function(){e.onClick(e.card)}}),Object(j.jsxs)("div",{className:"element__info",children:[Object(j.jsx)("h2",{className:"element__title",children:e.card.name}),Object(j.jsxs)("div",{className:"element__like-container",children:[Object(j.jsx)("button",{className:o,onClick:function(){e.onCardLike(e.card)}}),Object(j.jsx)("p",{className:"element__like-count",children:e.card.likes.length})]})]})]})})};var v=function(e){var t=a.a.useContext(g);return Object(j.jsxs)("main",{className:"content",children:[Object(j.jsxs)("section",{className:"profile",children:[Object(j.jsxs)("div",{className:"profile__container",children:[Object(j.jsx)("img",{className:"profile__avatar",src:t.avatar,alt:"userAvatar"}),Object(j.jsx)("div",{className:"profile__layout",children:Object(j.jsx)("button",{className:"profile__edit-avatar",onClick:e.onEditAvatar})})]}),Object(j.jsxs)("div",{className:"profile__info",children:[Object(j.jsxs)("div",{className:"profile__name-container",children:[Object(j.jsx)("h1",{className:"profile__title",children:t.name}),Object(j.jsx)("p",{className:"profile__subtitle",children:t.about})]}),Object(j.jsx)("button",{className:"profile__edit-button",onClick:e.onEditProfile})]}),Object(j.jsx)("button",{className:"profile__add-button",onClick:e.onAddPlace})]}),Object(j.jsx)("ul",{className:"elements",children:e.cards.map((function(t){return Object(j.jsx)(x,{card:t,onClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})]})};var N=function(e){var t=e.card,n=e.onClose;return Object(j.jsx)("section",{className:"pop-up pop-up_type_image ".concat(t&&"pop-up_opened"),children:Object(j.jsxs)("figure",{className:"pop-up_container_type_image",children:[Object(j.jsx)("img",{className:"pop-up__image",alt:t&&t.name,src:t&&"".concat(t.link)}),Object(j.jsx)("button",{className:"pop-up__close-button pop-up__image-close-button",onClick:n}),Object(j.jsx)("h4",{className:"pop-up__image-title",children:t&&t.name}),Object(j.jsx)("div",{className:"pop-up__overlay pop-up__overlay_type_image"})]})})};var y=function(e){var t=e.title,n=e.name,c=e.isOpen,a=e.onClose,o=e.submitButtonText,s=e.onSubmit,i=e.children;return Object(j.jsxs)("section",{className:c?" pop-up pop-up-".concat(n," pop-up_opened"):"pop-up pop-up-".concat(n),children:[Object(j.jsxs)("form",{className:"pop-up__container pop-up__form_type_".concat(n),action:"",method:"post",name:"enter",noValidate:!0,onSubmit:s,children:[Object(j.jsx)("button",{className:"pop-up__close-button pop-up__profile-close-button",type:"button",onClick:a}),Object(j.jsx)("h2",{className:"pop-up__title",children:t}),i,Object(j.jsx)("button",{className:"pop-up__submit-button pop-up__profile-submit-button",type:"submit",children:o})]}),Object(j.jsx)("div",{className:"pop-up__overlay pop-up__overlay_type_profile"})]})};var C=function(e){var t=a.a.useContext(g),n=a.a.useState(""),c=Object(l.a)(n,2),o=c[0],s=c[1],i=a.a.useState(""),r=Object(l.a)(i,2),u=r[0],p=r[1];return a.a.useEffect((function(){s(t.name),p(t.about)}),[t]),Object(j.jsx)(y,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"profile",isOpen:e.isOpen,onClose:e.onClose,submitButtonText:"C\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:u})},children:Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"pop-up__field pop-up__field_type_name",children:[Object(j.jsx)("input",{className:"pop-up__input pop-up__input_type_name",placeholder:"",required:!0,minLength:"2",maxLength:"40",id:"pop-up__input_type_name",name:"name",onChange:function(e){s(e.target.value)},value:o||""}),Object(j.jsx)("span",{className:"pop-up__error",id:"pop-up__input_type_name-error"})]}),Object(j.jsxs)("div",{className:"pop-up__field pop-up__field_type_description",children:[Object(j.jsx)("input",{className:"pop-up__input pop-up__input_type_description",placeholder:"",required:!0,minLength:"2",maxLength:"200",id:"pop-up__input_type_description",name:"description",onChange:function(e){p(e.target.value)},value:u||""}),Object(j.jsx)("span",{className:"pop-up__error",id:"pop-up__input_type_description-error"})]})]})})};function k(e){var t=Object(c.useRef)("");return Object(j.jsxs)(y,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"edit-avatar",isOpen:e.isOpen,onClose:e.onClose,submitButtonText:"C\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value}),t.current.value=""},children:[Object(j.jsx)("input",{className:"pop-up__input pop-up__input_type_avatar-link",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",required:!0,id:"pop-up__input_type_avatar-link",name:"avatar-link",ref:t}),Object(j.jsx)("span",{className:"pop-up__error",id:"pop-up__input_type_avatar-link-error"})]})}var S=function(e){var t=a.a.useState(""),n=Object(l.a)(t,2),c=n[0],o=n[1],s=a.a.useState(""),i=Object(l.a)(s,2),r=i[0],u=i[1];return Object(j.jsxs)(y,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"place",isOpen:e.isOpen,onClose:e.onClose,submitButtonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onSubmit:function(t){t.preventDefault(e.onAddPlace({name:c,link:r}))},children:[Object(j.jsxs)("div",{className:"pop-up__field pop-up__field_type_name",children:[Object(j.jsx)("input",{className:"pop-up__input pop-up__input_type_name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"1",maxLength:"30",id:"pop-up__input_type_name",name:"name",onChange:function(e){o(e.target.value)},value:c}),Object(j.jsx)("span",{className:"pop-up__error",id:"pop-up__input_type_name-error"})]}),Object(j.jsxs)("div",{className:"pop-up__field pop-up__field_type_link",children:[Object(j.jsx)("input",{className:"pop-up__input pop-up__input_type_image-link",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,id:"pop-up__input_type_image-link",name:"link",onChange:function(e){u(e.target.value)},value:r}),Object(j.jsx)("span",{className:"pop-up__error",id:"pop-up__input_type_image-link-error"})]})]})},P=function(e){var t=Object(c.useState)(""),n=Object(l.a)(t,2),a=n[0],o=n[1],s=Object(c.useState)(""),r=Object(l.a)(s,2),u=r[0],p=r[1];return Object(j.jsx)("div",{className:"register",children:Object(j.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.onRegister({email:a,password:u})},className:"register__form",children:[Object(j.jsx)("h2",{className:"register__form-title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(j.jsx)("input",{className:"register__input",id:"email",name:"email",type:"email",value:a,placeholder:"Email",onChange:function(e){o(e.target.value)}}),Object(j.jsx)("input",{className:"register__input",id:"password",name:"password",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:u,onChange:function(e){p(e.target.value)}}),Object(j.jsx)("button",{type:"submit",className:"register__link",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(j.jsxs)("div",{className:"register__signin",children:[Object(j.jsx)("p",{className:"register__login-question",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"}),Object(j.jsx)("div",{to:"login",className:"register__login-link",children:Object(j.jsx)(i.b,{to:"/signin",type:"button",className:"register__login",children:"\u0412\u043e\u0439\u0442\u0438"})})]})]})})},w=function(e){var t=Object(c.useState)(""),n=Object(l.a)(t,2),a=n[0],o=n[1],s=Object(c.useState)(""),i=Object(l.a)(s,2),r=i[0],u=i[1];return Object(j.jsx)("div",{className:"login",children:Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault()},className:"login__form",children:[Object(j.jsx)("h2",{className:"login__form-title",children:"\u0412\u0445\u043e\u0434"}),Object(j.jsx)("input",{placeholder:"Email",className:"login__input",id:"email",name:"email",type:"email",value:a,onChange:function(e){o(e.target.value)}}),Object(j.jsx)("input",{className:"login__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"password",name:"password",type:"password",value:r,onChange:function(e){u(e.target.value)}}),Object(j.jsx)("button",{type:"submit",className:"login__link",children:"\u0412\u043e\u0439\u0442\u0438"})]})})},T=n.p+"static/media/Yes.1b6082f8.svg",E=n.p+"static/media/No.df8eddf6.svg";var L=function(e){return Object(j.jsxs)("section",{className:e.isOpen?" pop-up  pop-up_opened":"pop-up ",children:[Object(j.jsxs)("form",{className:"pop-up__container ",action:"",method:"post",name:"enter",noValidate:!0,children:[Object(j.jsx)("button",{className:"pop-up__close-button pop-up__profile-close-button",type:"button",onClick:e.onClose}),Object(j.jsx)("div",{className:"info-tool-tip",children:Object(j.jsxs)("div",{className:"info-tool-tip__container",children:[Object(j.jsx)("img",{alt:"succes-or-fail",src:e.isRegistered?T:E}),Object(j.jsx)("h3",{className:"info-tool-tip__title",children:e.isRegistered?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c":"\u0427\u0442\u043e \u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435\u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0443\u0431\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437!"})]})})]}),Object(j.jsx)("div",{className:"pop-up__overlay pop-up__overlay_type_profile"})]})},A="https://auth.nomoreparties.co";var I=function(){var e=Object(c.useState)(!1),t=Object(l.a)(e,2),n=t[0],o=t[1],s=Object(c.useState)(!1),i=Object(l.a)(s,2),p=i[0],d=i[1],b=Object(c.useState)(!1),f=Object(l.a)(b,2),x=f[0],y=f[1],T=Object(c.useState)(!1),E=Object(l.a)(T,2),I=E[0],D=E[1],U=Object(c.useState)(null),B=Object(l.a)(U,2),J=B[0],R=B[1],q=Object(c.useState)({}),F=Object(l.a)(q,2),z=F[0],G=F[1],H=a.a.useState([]),M=Object(l.a)(H,2),V=M[0],Y=M[1],K=Object(u.g)(),Q=Object(c.useState)(!1),W=Object(l.a)(Q,2),X=W[0],Z=W[1],$=Object(c.useState)(!1),ee=Object(l.a)($,2),te=ee[0],ne=ee[1],ce=Object(c.useState)(""),ae=Object(l.a)(ce,2),oe=ae[0],se=ae[1];function ie(){o(!1),d(!1),y(!1),R(null),D(!1)}return Object(c.useEffect)((function(){!function(){var e=localStorage.getItem("jwt");e&&function(e){return fetch("".concat(A,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))}(e).then((function(e){var t=e.data.email;se(t),ne(!0),K.push("/")})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}()}),[]),a.a.useEffect((function(){O.getProfileInfo().then((function(e){G(e)})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}),[]),a.a.useEffect((function(){O.getInitialCards().then((function(e){Y(e)})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}),[]),Object(j.jsx)(g.Provider,{value:z,children:Object(j.jsxs)("div",{className:"page__container",children:[Object(j.jsx)(m,{isLoggedIn:te,email:oe,onOut:function(){localStorage.removeItem("jwt"),ne(!1)}}),Object(j.jsxs)(u.d,{children:[Object(j.jsx)(u.b,{path:"/signup",children:Object(j.jsx)(P,{onRegister:function(e){var t,n;(t=e.email,n=e.password,fetch("".concat(A,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))).then((function(e){Z(!0),D(!0),K.push("/")})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e)),Z(!1),D(!0)}))}})}),Object(j.jsx)(u.b,{path:"/signin",children:Object(j.jsx)(w,{onLogin:function(e){var t,n;(t=e.email,n=e.password,fetch("".concat(A,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}).then((function(e){return e.json()})).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),e})).catch((function(e){return console.log(e)}))).then((function(t){localStorage.setItem("jwt",t.token),ne(!0),se(e.email),K.push("/")})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}})}),Object(j.jsx)(_,{path:"/",loggedIn:te,component:v,email:oe,cards:V,onEditAvatar:function(){y(!0)},onEditProfile:function(){o(!0)},onAddPlace:function(){d(!0)},onCardClick:function(e){R(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===z._id}));O.changeLikeCardStatus(e._id,!t).then((function(t){var n=V.map((function(n){return n._id===e._id?t:n}));Y(n)}))},onCardDelete:function(e){O.deleteCard(e._id).then((function(){var t=V.filter((function(t){return t._id!==e._id}));Y(t)})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}})]}),Object(j.jsx)(N,{card:J,onClose:ie}),Object(j.jsx)(C,{isOpen:n,onClose:ie,onUpdateUser:function(e){O.editProfile(e).then((function(e){G(e),ie()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}}),Object(j.jsx)(k,{isOpen:x,onClose:ie,onUpdateAvatar:function(e){O.updateUserAvatar(e).then((function(e){G(e),ie()}))}}),Object(j.jsx)(S,{isOpen:p,onClose:ie,onAddPlace:function(e){O.addNewCard(e).then((function(e){Y([e].concat(Object(r.a)(V))),ie()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e))}))}}),Object(j.jsx)(L,{isRegistered:X,isOpen:I,onClose:ie}),Object(j.jsx)(h,{})]})})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,449)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),o(e),s(e)}))};s.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(i.a,{children:Object(j.jsx)(I,{})})}),document.getElementById("root")),D()}},[[448,1,2]]]);
//# sourceMappingURL=main.1a549eb9.chunk.js.map